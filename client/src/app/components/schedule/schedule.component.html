<div class="container">
  <h1 class="text-center">Worker Schedule</h1>
  <div class="d-flex justify-content-between mb-3">
    <button class="btn btn-primary" (click)="previousWeek()">
      Previous Week
    </button>
    <h3>Week of {{ formatWeekForDisplay() }}</h3>
    <button class="btn btn-primary" (click)="nextWeek()">Next Week</button>
  </div>
  <table class="table table-bordered">
    <thead>
      <tr>
        <th></th>
        <th *ngFor="let day of weekDays" class="text-center">
          <div class="weekday-name">{{ getDayName(day) }}</div>
        </th>
      </tr>
      <tr>
        <th></th>
        <th *ngFor="let day of weekDays" class="text-center">
          <div class="day-number">{{ formatDateForDisplay(day) }}</div>
        </th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let job of jobOptions">
        <th class="text-center">{{ job.title }}</th>
        <td *ngFor="let day of weekDays" class="text-center">
          <div
            *ngFor="let shift of getShiftsForDateAndRole(day, job.id)"
            class="shift"
            [attr.data-shift-type]="determineShift(shift.startTime)"
          >
            {{ determineShift(shift.startTime) }} -
            {{ shift.firstName + " " + shift.lastName }}
            <a *ngIf="getRoleFromToken() == 1" class="link-danger" (click)="deleteSchedule(shift.id)">Delete</a>
          </div>
        </td>
      </tr>
    </tbody>
  </table>
  <!-- <p class="text-center">
    You are {{ getRoleFromToken() == 1 ? "an Admin" : "a Worker" }}
  </p> -->
  <div *ngIf="getRoleFromToken() == 2" style="width: 500px; margin: auto;">
    <form class="form" [formGroup]="scheduleForm">  
      <div class="form-group">
        <label for="shiftDate">Select Date:</label>
        <input
          type="date"
          id="shiftDate"
          class="form-control"
          formControlName="shiftDate"
          name="shiftDate"
          required
        />
      </div>
      <br>
      <div class="form-group">
        <label for="shiftType">Select Shift:</label>
        <select
          id="shiftType"
          class="form-control"
          formControlName="shiftType"
          name="shiftType"
          required
        >
          <option value="morning">Morning</option>
          <option value="evening">Evening</option>
        </select>
      </div>
      <br>
      <button type="button" class="btn btn-success" (click)="addScheduleRequest()">
        Add Schedule
      </button>
    </form>
  </div>
  <div *ngIf="getRoleFromToken() == 1" style="width: 600px; margin: auto;">
    <div class="container mt-4 mb-5">
      <h3 class="text-center">Schedule Requests</h3>
      <br>
      <ul class="list-group">
        <li *ngFor="let shift of getUnapprovedShifts()" class="list-group-item d-flex justify-content-between align-items-center">
          <div>
            <strong>Worker:</strong> {{ shift.firstName + " " + shift.lastName }} <br>
            <strong>Request:</strong> {{ determineShift(shift.startTime) }} Shift on {{ getMonthName(shift.startTime) }} {{ getDayNumber(shift.startTime) }}, 2025
          </div>
          <div>
            <button class="btn btn-success btn-sm me-2" (click)="approveScheduleRequest(shift.id)">Approve</button>
            <button class="btn btn-danger btn-sm" (click)="deleteSchedule(shift.id)">Decline</button>
          </div>
        </li>
        <li *ngIf="getUnapprovedShifts().length === 0" class="list-group-item text-center">
          No requests at the moment.
        </li>
      </ul>
    </div>
  </div>
  <div *ngIf="successMessage" class="alert alert-success mt-3">
    {{ successMessage }}
  </div>
  <div *ngIf="errorMessage" class="alert alert-danger mt-3">
    {{ errorMessage }}
  </div>      
</div>
